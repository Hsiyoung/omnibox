# OmniBox æºç ä¿®æ”¹ä¸å¼€å‘æŒ‡å—

## é¡¹ç›®æ¶æ„

OmniBox æ˜¯ä¸€ä¸ªå¾®æœåŠ¡æ¶æ„çš„åº”ç”¨ï¼ŒåŒ…å«ä»¥ä¸‹å‡ ä¸ªä¸»è¦ç»„ä»¶ï¼š

### 1. backend (åç«¯ API)
- **æŠ€æœ¯æ ˆ**: Python + FastAPI
- **åŠŸèƒ½**: ç”¨æˆ·ç®¡ç†ã€æ–‡æ¡£å¤„ç†ã€æƒé™æ§åˆ¶
- **ç«¯å£**: 8000
- **å…³é”®æ–‡ä»¶**:
  ```
  backend/
  â”œâ”€â”€ app/
  â”‚   â”œâ”€â”€ main.py          # ä¸»å…¥å£æ–‡ä»¶
  â”‚   â”œâ”€â”€ models/          # æ•°æ®åº“æ¨¡å‹
  â”‚   â”œâ”€â”€ api/             # API è·¯ç”±
  â”‚   â”œâ”€â”€ services/        # ä¸šåŠ¡é€»è¾‘
  â”‚   â””â”€â”€ core/            # æ ¸å¿ƒé…ç½®
  â”œâ”€â”€ requirements.txt     # Python ä¾èµ–
  â””â”€â”€ Dockerfile          # å®¹å™¨æ„å»ºæ–‡ä»¶
  ```

### 2. web (å‰ç«¯ç•Œé¢)
- **æŠ€æœ¯æ ˆ**: React + TypeScript
- **åŠŸèƒ½**: ç”¨æˆ·ç•Œé¢ã€æ–‡æ¡£ç®¡ç†ã€èŠå¤©ç•Œé¢
- **ç«¯å£**: 80 (8080 å¯¹å¤–)
- **å…³é”®æ–‡ä»¶**:
  ```
  web/
  â”œâ”€â”€ src/
  â”‚   â”œâ”€â”€ components/      # React ç»„ä»¶
  â”‚   â”œâ”€â”€ pages/          # é¡µé¢ç»„ä»¶
  â”‚   â”œâ”€â”€ services/       # API æœåŠ¡
  â”‚   â””â”€â”€ App.tsx         # ä¸»åº”ç”¨
  â”œâ”€â”€ package.json        # Node.js ä¾èµ–
  â””â”€â”€ vite.config.ts      # æ„å»ºé…ç½®
  ```

### 3. wizard (AI å¤„ç†æœåŠ¡)
- **æŠ€æœ¯æ ˆ**: Python + FastAPI
- **åŠŸèƒ½**: AI æ–‡æ¡£å¤„ç†ã€å‘é‡å­˜å‚¨ã€RAG
- **ç«¯å£**: 8000
- **å…³é”®æ–‡ä»¶**:
  ```
  wizard/
  â”œâ”€â”€ main.py             # ä¸»å…¥å£
  â”œâ”€â”€ services/           # AI æœåŠ¡
  â”œâ”€â”€ models/             # æ•°æ®æ¨¡å‹
  â””â”€â”€ requirements.txt
  ```

### 4. client/browser-extension (æµè§ˆå™¨æ‰©å±•)
- **æŠ€æœ¯æ ˆ**: JavaScript + Manifest V3
- **åŠŸèƒ½**: ç½‘é¡µå†…å®¹æŠ“å–ã€Omnibox é›†æˆ
- **å…³é”®æ–‡ä»¶**:
  ```
  client/browser-extension/
  â”œâ”€â”€ manifest.json       # æ‰©å±•é…ç½®
  â”œâ”€â”€ background.js       # åå°è„šæœ¬
  â”œâ”€â”€ content.js          # å†…å®¹è„šæœ¬
  â””â”€â”€ popup/              # å¼¹çª—ç•Œé¢
  ```

## å¼€å‘ç¯å¢ƒè®¾ç½®

### æ–¹æ³•ä¸€ï¼šå®Œæ•´æºç å¼€å‘ï¼ˆæ¨èï¼‰

1. **æ‹‰å–å®Œæ•´æºç **:
```bash
# å…‹éš†ä¸»ä»“åº“
git clone --recurse-submodules https://github.com/import-ai/omnibox.git
cd omnibox

# æˆ–è€…å¦‚æœå·²æœ‰ä»“åº“ä½†å­æ¨¡å—ä¸ºç©º
git submodule update --init --recursive
```

2. **å¯åŠ¨å¼€å‘ç¯å¢ƒ**:
```bash
# ä½¿ç”¨å¼€å‘æ¨¡å¼å¯åŠ¨
bash scripts/dev.sh up -d --build
```

3. **å¼€å‘è°ƒè¯•**:
   - åç«¯ API: http://localhost:8000
   - å‰ç«¯ç•Œé¢: http://localhost:8080
   - Wizard API: http://localhost:8001

### æ–¹æ³•äºŒï¼šç‹¬ç«‹ç»„ä»¶å¼€å‘

å¦‚æœä½ åªæƒ³ä¿®æ”¹æŸä¸ªç‰¹å®šç»„ä»¶ï¼Œå¯ä»¥å•ç‹¬å…‹éš†ï¼š

#### åç«¯å¼€å‘
```bash
git clone https://github.com/import-ai/omnibox-backend.git
cd omnibox-backend
pip install -r requirements.txt
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

#### å‰ç«¯å¼€å‘
```bash
git clone https://github.com/import-ai/omnibox-web.git
cd omnibox-web
npm install
npm run dev
```

#### Wizard å¼€å‘
```bash
git clone https://github.com/import-ai/omnibox-wizard.git
cd omnibox-wizard
pip install -r requirements.txt
python main.py
```

## å¸¸è§ä¿®æ”¹åœºæ™¯

### 1. æ·»åŠ æ–°çš„ API ç«¯ç‚¹ (åç«¯)

åœ¨ `backend/app/api/` ä¸‹åˆ›å»ºæ–°çš„è·¯ç”±æ–‡ä»¶ï¼š

```python
# backend/app/api/v1/health.py
from fastapi import APIRouter

router = APIRouter()

@router.get("/health")
async def health_check():
    return {"status": "ok", "message": "Omnibox is running"}

@router.post("/custom-feature")
async def custom_feature(data: dict):
    # ä½ çš„è‡ªå®šä¹‰é€»è¾‘
    return {"result": "processed", "data": data}
```

ç„¶ååœ¨ `app/api/__init__.py` ä¸­æ³¨å†Œè·¯ç”±ï¼š

```python
from .v1.health import router as health_router

# æ³¨å†Œè·¯ç”±
app.include_router(health_router, prefix="/api/v1", tags=["health"])
```

### 2. æ·»åŠ æ–°çš„å‰ç«¯é¡µé¢ (Web)

åœ¨ `web/src/pages/` ä¸‹åˆ›å»ºæ–°é¡µé¢ï¼š

```tsx
// web/src/pages/CustomFeature.tsx
import React from 'react';
import { useState } from 'react';

const CustomFeature: React.FC = () => {
  const [data, setData] = useState('');

  const handleSubmit = async () => {
    // è°ƒç”¨åç«¯ API
    const response = await fetch('/api/v1/custom-feature', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ data })
    });
    const result = await response.json();
    console.log(result);
  };

  return (
    <div>
      <h1>æˆ‘çš„è‡ªå®šä¹‰åŠŸèƒ½</h1>
      <input 
        value={data} 
        onChange={(e) => setData(e.target.value)}
        placeholder="è¾“å…¥æ•°æ®"
      />
      <button onClick={handleSubmit}>æäº¤</button>
    </div>
  );
};

export default CustomFeature;
```

ç„¶ååœ¨ `App.tsx` ä¸­æ·»åŠ è·¯ç”±ï¼š

```tsx
import CustomFeature from './pages/CustomFeature';

// åœ¨è·¯ç”±ä¸­æ·»åŠ 
<Route path="/custom" element={<CustomFeature />} />
```

### 3. ä¿®æ”¹æµè§ˆå™¨æ‰©å±•

åœ¨ `client/browser-extension/` ä¸‹ä¿®æ”¹ç›¸å…³æ–‡ä»¶ï¼š

```javascript
// client/browser-extension/content.js
// æ·»åŠ æ–°çš„å†…å®¹å¤„ç†é€»è¾‘
chrome.runtime.onMessage.addListener((request, sender, sendResponse) => {
  if (request.action === "extractContent") {
    // æå–ç½‘é¡µå†…å®¹çš„è‡ªå®šä¹‰é€»è¾‘
    const content = document.body.innerText;
    sendResponse({ content: content });
  }
});
```

### 4. æ·»åŠ æ–°çš„ AI å¤„ç†åŠŸèƒ½ (Wizard)

åœ¨ `wizard/services/` ä¸‹æ·»åŠ æ–°çš„å¤„ç†æœåŠ¡ï¼š

```python
# wizard/services/custom_processor.py
class CustomProcessor:
    def __init__(self):
        pass
    
    def process_document(self, document):
        # è‡ªå®šä¹‰æ–‡æ¡£å¤„ç†é€»è¾‘
        processed = {
            "original": document,
            "processed_at": datetime.now().isoformat(),
            "custom_field": "ä½ çš„è‡ªå®šä¹‰å­—æ®µ"
        }
        return processed
```

## å¼€å‘å·¥ä½œæµ

### 1. ä¿®æ”¹ä»£ç 
- é€‰æ‹©ä½ è¦ä¿®æ”¹çš„ç»„ä»¶ï¼ˆbackend/web/wizardï¼‰
- æ ¹æ®ä¸Šè¿°æŒ‡å—è¿›è¡Œä»£ç ä¿®æ”¹
- æµ‹è¯•ä½ çš„åŠŸèƒ½

### 2. æœ¬åœ°æµ‹è¯•
```bash
# å¼€å‘æ¨¡å¼ä¸‹æµ‹è¯•
docker compose -f compose.yaml -f compose/dev.yaml up -d --build

# æŸ¥çœ‹æ—¥å¿—
docker compose logs -f [service_name]
```

### 3. æ„å»ºå’Œéƒ¨ç½²
```bash
# æ„å»ºç”Ÿäº§é•œåƒ
docker build -t my-omnibox-backend ./backend
docker build -t my-omnibox-web ./web

# ä½¿ç”¨è‡ªå®šä¹‰é•œåƒéƒ¨ç½²
docker compose up -d
```

## è°ƒè¯•æŠ€å·§

### 1. æŸ¥çœ‹æ—¥å¿—
```bash
# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker compose logs -f backend
docker compose logs -f web
docker compose logs -f wizard

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
docker compose logs -f --tail=50
```

### 2. è¿›å…¥å®¹å™¨è°ƒè¯•
```bash
# è¿›å…¥åç«¯å®¹å™¨
docker compose exec backend bash

# è¿›å…¥å‰ç«¯å®¹å™¨
docker compose exec web sh

# è¿›å…¥ Wizard å®¹å™¨
docker compose exec wizard python
```

### 3. æ•°æ®åº“è°ƒè¯•
```bash
# è¿æ¥ PostgreSQL
docker compose exec postgres psql -U omnibox -d omnibox

# è¿æ¥ Meilisearch
docker compose exec meilisearch curl http://localhost:7700/health
```

## æœ€ä½³å®è·µ

1. **ä»£ç ç»“æ„**: ä¿æŒæ¸…æ™°çš„æ¨¡å—åŒ–ç»“æ„
2. **API è®¾è®¡**: éµå¾ª RESTful API è§„èŒƒ
3. **é”™è¯¯å¤„ç†**: æ·»åŠ é€‚å½“çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—
4. **æµ‹è¯•**: ç¼–å†™å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
5. **æ–‡æ¡£**: æ›´æ–°ç›¸å…³æ–‡æ¡£å’Œæ³¨é‡Š
6. **ç‰ˆæœ¬æ§åˆ¶**: ä½¿ç”¨ Git è¿›è¡Œç‰ˆæœ¬ç®¡ç†

## æŠ€æœ¯æ”¯æŒ

å¦‚æœåœ¨å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼š

1. æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£: https://www.omnibox.pro/docs
2. è®¿é—® GitHub Issues: https://github.com/import-ai/omnibox/issues
3. è”ç³»ç¤¾åŒºæ”¯æŒ

ç¥ä½ å¼€å‘æ„‰å¿«ï¼ğŸš€